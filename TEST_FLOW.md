# æµ‹è¯•æµç¨‹æŒ‡å—

## é—®é¢˜è¯Šæ–­

### é—®é¢˜æè¿°
ç‚¹å‡»"å¼€å§‹ä»Šæ—¥é—®è¯Š"ä¹‹åï¼Œloading é¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåç»­é¡µé¢ä¹Ÿå‡ºä¸æ¥äº†ã€‚

### å·²ä¿®å¤çš„é—®é¢˜

#### 1. React Hooks è§„åˆ™è¿å
**é—®é¢˜**ï¼š`renderAnalyzing` å‡½æ•°å†…éƒ¨ä½¿ç”¨äº† `useState` å’Œ `useEffect`ï¼Œè¿åäº† React Hooks çš„è§„åˆ™ã€‚

**åŸå› **ï¼šHooks åªèƒ½åœ¨ç»„ä»¶çš„é¡¶å±‚è°ƒç”¨ï¼Œä¸èƒ½åœ¨æ™®é€šå‡½æ•°ä¸­è°ƒç”¨ã€‚

**ä¿®å¤**ï¼š
- å°†çŠ¶æ€æå‡åˆ° App ç»„ä»¶çš„é¡¶å±‚
- å°† `currentTipIndex` å’Œ `fadeClass` çŠ¶æ€ç§»åˆ° App ç»„ä»¶
- å°† `useEffect` ç§»åˆ° App ç»„ä»¶ï¼Œå¹¶æ·»åŠ  `step` ä¾èµ–
- `renderAnalyzing` æ”¹ä¸ºçº¯æ¸²æŸ“å‡½æ•°

**ä¿®å¤å‰**ï¼š
```tsx
const renderAnalyzing = () => {
  const [currentTipIndex, setCurrentTipIndex] = useState(0);  // âŒ é”™è¯¯
  const [fadeClass, setFadeClass] = useState('opacity-100');  // âŒ é”™è¯¯
  
  useEffect(() => {  // âŒ é”™è¯¯
    // ...
  }, []);
  
  return <div>...</div>;
};
```

**ä¿®å¤å**ï¼š
```tsx
const App: React.FC = () => {
  // ... å…¶ä»–çŠ¶æ€
  const [currentTipIndex, setCurrentTipIndex] = useState(0);  // âœ… æ­£ç¡®
  const [fadeClass, setFadeClass] = useState('opacity-100');  // âœ… æ­£ç¡®
  
  useEffect(() => {  // âœ… æ­£ç¡®
    if (step !== AppStep.ANALYZING) return;
    // ...
  }, [step]);
  
  const renderAnalyzing = () => (  // âœ… çº¯æ¸²æŸ“å‡½æ•°
    <div>...</div>
  );
};
```

## æµ‹è¯•æ­¥éª¤

### 1. æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€

```bash
# æ£€æŸ¥åç«¯æœåŠ¡å™¨
curl http://localhost:3001/api/health

# æ£€æŸ¥å‰ç«¯æœåŠ¡å™¨
curl http://localhost:3000
```

**é¢„æœŸç»“æœ**ï¼š
- åç«¯è¿”å›ï¼š`{"status":"ok","hasApiKey":true,"timestamp":"..."}`
- å‰ç«¯è¿”å›ï¼šHTML é¡µé¢

### 2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹ï¼š

1. **Console æ ‡ç­¾**ï¼š
   - ä¸åº”è¯¥æœ‰ React Hooks ç›¸å…³çš„é”™è¯¯
   - ä¸åº”è¯¥æœ‰ "Rendered more hooks than during the previous render" é”™è¯¯

2. **Network æ ‡ç­¾**ï¼š
   - æ£€æŸ¥ API è¯·æ±‚æ˜¯å¦æ­£å¸¸å‘é€
   - æ£€æŸ¥å“åº”çŠ¶æ€ç æ˜¯å¦ä¸º 200

3. **React DevTools**ï¼ˆå¦‚æœå®‰è£…ï¼‰ï¼š
   - æ£€æŸ¥ç»„ä»¶æ ‘æ˜¯å¦æ­£å¸¸æ¸²æŸ“
   - æ£€æŸ¥ App ç»„ä»¶çš„ state æ˜¯å¦æ­£ç¡®æ›´æ–°

### 3. æµ‹è¯•å®Œæ•´æµç¨‹

#### Step 1: æ¬¢è¿é¡µé¢
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] "å¼€å¯ä»Šæ—¥é—®è¯Š" æŒ‰é’®å¯ç‚¹å‡»

#### Step 2: è¾“å…¥é¡µé¢
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] å¯ä»¥ä¸Šä¼ å›¾ç‰‡
- [ ] å¯ä»¥é€‰æ‹©é€‰é¡¹
- [ ] "å¼€å§‹è¯Šæ–­" æŒ‰é’®å¯ç‚¹å‡»

#### Step 3: åˆ†æé¡µé¢ï¼ˆé‡ç‚¹æµ‹è¯•ï¼‰
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] åŠ è½½åŠ¨ç”»æ­£å¸¸æ—‹è½¬
- [ ] æç¤ºè¯­æ­£å¸¸è½®æ’­ï¼ˆæ¯ 2.5 ç§’åˆ‡æ¢ä¸€æ¬¡ï¼‰
- [ ] æç¤ºè¯­æœ‰æ·¡å…¥æ·¡å‡ºæ•ˆæœ
- [ ] ä¸ä¼šå¡ä½æˆ–ç™½å±

#### Step 4: ç»“æœé¡µé¢
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] è¯Šæ–­ç»“æœæ­£å¸¸å±•ç¤º
- [ ] é›·è¾¾å›¾æ­£å¸¸æ¸²æŸ“

### 4. å¼€å‘è€…æ¨¡å¼æµ‹è¯•

#### å¯ç”¨å¼€å‘è€…æ¨¡å¼
1. åœ¨æ¬¢è¿é¡µé¢ï¼Œç‚¹å‡» Logo 7 æ¬¡
2. æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š`"Internal: Developer mode enabled. Rate limit bypassed."`

#### æµ‹è¯•ä¼˜åŠ¿
- ç»•è¿‡ 24 å°æ—¶é™åˆ¶
- å¯ä»¥å¤šæ¬¡æµ‹è¯•
- æŸ¥çœ‹è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—

### 5. æ¨¡æ‹Ÿæ”¯ä»˜æµ‹è¯•

å¦‚æœéœ€è¦æµ‹è¯•å®Œæ•´æŠ¥å‘Šï¼š
1. åœ¨ç»“æœé¡µé¢ç‚¹å‡»"è§£é”å®Œæ•´é™ªè·‘æŠ¥å‘Š"
2. åœ¨æ”¯ä»˜å¼¹çª—ç‚¹å‡»"æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ"
3. åº”è¯¥è·³è½¬åˆ°å®Œæ•´æŠ¥å‘Šé¡µé¢

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šé¡µé¢ç™½å±

**å¯èƒ½åŸå› **ï¼š
- React Hooks è§„åˆ™è¿åï¼ˆå·²ä¿®å¤ï¼‰
- JavaScript é”™è¯¯

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ Network æ ‡ç­¾ï¼Œç¡®è®¤èµ„æºåŠ è½½æ­£å¸¸
3. æ£€æŸ¥ React DevToolsï¼Œç¡®è®¤ç»„ä»¶æ ‘æ­£å¸¸

### é—®é¢˜ 2ï¼šåŠ è½½é¡µé¢å¡ä½

**å¯èƒ½åŸå› **ï¼š
- API è¯·æ±‚å¤±è´¥
- åç«¯æœåŠ¡å™¨æœªå¯åŠ¨
- ç½‘ç»œé—®é¢˜

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥åç«¯æœåŠ¡å™¨æ˜¯å¦è¿è¡Œï¼š`curl http://localhost:3001/api/health`
2. æ£€æŸ¥æµè§ˆå™¨ Network æ ‡ç­¾ï¼ŒæŸ¥çœ‹ API è¯·æ±‚çŠ¶æ€
3. æ£€æŸ¥åç«¯æ—¥å¿—ï¼šæŸ¥çœ‹ server è¿›ç¨‹çš„è¾“å‡º

### é—®é¢˜ 3ï¼šæç¤ºè¯­ä¸è½®æ’­

**å¯èƒ½åŸå› **ï¼š
- useEffect ä¾èµ–é¡¹é”™è¯¯
- çŠ¶æ€æ›´æ–°é—®é¢˜

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ `step` æ˜¯å¦ä¸º `AppStep.ANALYZING`
2. æ£€æŸ¥ `useEffect` æ˜¯å¦æ­£å¸¸æ‰§è¡Œ
3. åœ¨æ§åˆ¶å°æ·»åŠ  `console.log` è°ƒè¯•

### é—®é¢˜ 4ï¼šAPI è¯·æ±‚å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- è±†åŒ… API Key æ— æ•ˆ
- ç½‘ç»œé—®é¢˜
- è¯·æ±‚æ ¼å¼é”™è¯¯

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ `.env.local` ä¸­çš„ `DOUBAO_API_KEY`
2. æ£€æŸ¥åç«¯æ—¥å¿—ï¼ŒæŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
3. ä½¿ç”¨ curl æµ‹è¯• APIï¼š
   ```bash
   curl -X POST http://localhost:3001/api/doubao \
     -H "Content-Type: application/json" \
     -d '{"model":"doubao-seed-1-8-251228","messages":[{"role":"user","content":"test"}]}'
   ```

## è°ƒè¯•æŠ€å·§

### 1. æ·»åŠ æ§åˆ¶å°æ—¥å¿—

åœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—ï¼š

```tsx
const handleSubmit = async (e: React.FormEvent) => {
  e.preventDefault();
  console.log('ğŸ” å¼€å§‹è¯Šæ–­', context);  // æ·»åŠ æ—¥å¿—
  
  if (!context.profileImage) {
    alert("ä¸»é¡µè¯Šæ–­ä½ä¸å¯æˆ–ç¼ºå“¦ï½");
    return;
  }
  
  setStep(AppStep.ANALYZING);
  console.log('ğŸ” åˆ‡æ¢åˆ°åˆ†æé¡µé¢');  // æ·»åŠ æ—¥å¿—
  
  try {
    const data = await diagnoseAccount(context);
    console.log('ğŸ” è¯Šæ–­æˆåŠŸ', data);  // æ·»åŠ æ—¥å¿—
    setResult(data);
    setStep(AppStep.RESULT);
  } catch (err) {
    console.error('ğŸ” è¯Šæ–­å¤±è´¥', err);  // æ·»åŠ æ—¥å¿—
    setStep(AppStep.INPUT);
    alert("ä¿¡å·å¾®å¼±ï¼Œå’±ä»¬é‡è¯•ä¸€ä¸‹ï¼Ÿ");
  }
};
```

### 2. ä½¿ç”¨ React DevTools

1. å®‰è£… React DevTools æµè§ˆå™¨æ‰©å±•
2. æ‰“å¼€ Components æ ‡ç­¾
3. é€‰æ‹© App ç»„ä»¶
4. æŸ¥çœ‹ state å’Œ props
5. å®æ—¶è§‚å¯ŸçŠ¶æ€å˜åŒ–

### 3. ä½¿ç”¨ Network é¢æ¿

1. æ‰“å¼€ Network æ ‡ç­¾
2. ç­›é€‰ XHR/Fetch è¯·æ±‚
3. æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…ï¼š
   - Request Headers
   - Request Payload
   - Response
   - Timing

### 4. ä½¿ç”¨æ–­ç‚¹è°ƒè¯•

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­ï¼š
1. æ‰“å¼€ Sources æ ‡ç­¾
2. æ‰¾åˆ° App.tsx æ–‡ä»¶
3. åœ¨å…³é”®è¡Œè®¾ç½®æ–­ç‚¹
4. é‡æ–°æ‰§è¡Œæ“ä½œ
5. é€æ­¥è°ƒè¯•

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“

```tsx
// ä½¿ç”¨ useMemo ç¼“å­˜æç¤ºè¯­æ•°ç»„
const analyzingTips = useMemo(() => [
  "æ­£åœ¨æ‰«æä½ çš„è´¦å·ç»“æ„â€¦",
  "å·²åŒ¹é…åŒç±»è´¦å·æˆé•¿æ¨¡å‹â€¦",
  "åˆ†æä½ çš„ä¸»é¡µä¿¡å·å¼ºåº¦â€¦",
  "å¯¹æ¯”è¿·èŒ«æœŸå¸¸è§å¡ç‚¹ä¸­â€¦",
  "æ­£åœ¨ç”Ÿæˆä½ çš„å…³é”®åˆ¤æ–­â€¦"
], []);
```

### 2. ä¼˜åŒ– useEffect ä¾èµ–

```tsx
// ç¡®ä¿ä¾èµ–é¡¹æ­£ç¡®
useEffect(() => {
  if (step !== AppStep.ANALYZING) return;
  
  const interval = setInterval(() => {
    // ...
  }, 2500);
  
  return () => clearInterval(interval);
}, [step, analyzingTips.length]);  // æ·»åŠ å¿…è¦çš„ä¾èµ–
```

### 3. é”™è¯¯è¾¹ç•Œ

è€ƒè™‘æ·»åŠ é”™è¯¯è¾¹ç•Œç»„ä»¶ï¼š

```tsx
class ErrorBoundary extends React.Component {
  componentDidCatch(error, errorInfo) {
    console.error('Error caught by boundary:', error, errorInfo);
  }
  
  render() {
    return this.props.children;
  }
}
```

## å½“å‰çŠ¶æ€

âœ… React Hooks é”™è¯¯å·²ä¿®å¤
âœ… å‰ç«¯æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:3000ï¼‰
âœ… åç«¯æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:3001ï¼‰
âœ… TypeScript ç¼–è¯‘æ— é”™è¯¯
âœ… çƒ­æ›´æ–°æ­£å¸¸å·¥ä½œ

## ä¸‹ä¸€æ­¥

1. åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•å®Œæ•´æµç¨‹
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. å¦‚æœè¿˜æœ‰é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šè¿°æ’æŸ¥æ­¥éª¤é€ä¸€æ£€æŸ¥
4. è®°å½•ä»»ä½•æ–°çš„é”™è¯¯ä¿¡æ¯ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥è¯Šæ–­
